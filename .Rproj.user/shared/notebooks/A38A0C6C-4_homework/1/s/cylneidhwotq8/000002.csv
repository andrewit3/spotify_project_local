"0","Kgrid      = c(5,7,10,15,20,25)"
"0","CVestimate = rep(0,length(Kgrid))"
"0","CVse       = rep(0,length(Kgrid))"
"0","Kiter      = 0"
"0","for(K in Kgrid){"
"0","  Kiter             = Kiter + 1"
"0","  folds             = sample(rep(1:K, length.out = n))"
"0","  CVestimateVec     = unlist(foreach(k = 1:K) %dopar%{cvF(k, folds)})"
"0","  CVestimate[Kiter] = mean(CVestimateVec)"
"0","  CVse[Kiter]       = sd(CVestimateVec)/sqrt(K)"
"0","}"
"0",""
"0",""
"0","# Let's make a plot"
"0","df = data.frame('K' = Kgrid,"
"0","                'KfoldCV' = CVestimate,"
"0","                'SEofCV'  = CVse)"
"0","# This uses the latticeExtra package"
"0","plt1 = xyplot(KfoldCV ~ Kgrid, df, type = ""l"" , lty=1)"
"0","plt2 = xyplot(SEofCV ~ Kgrid, df, type = ""l"", lty=2)"
"0"," "
"0","doubleYScale(plt1, plt2, add.ylab2 = TRUE,"
"0","             text = names(df)[-1])"
