"0","set.seed(22)"
"0","breastData = read.csv(""./breastData.csv"", header=FALSE)"
"0","dim(breastData)"
"1","[1]"
"1"," 569"
"1","  30"
"1","
"
"0","n = nrow(breastData)"
"0","p = ncol(breastData)"
"0","ch.index = function(x,kmax,iter.max=100,nstart=10,"
"0",""
"0","algorithm=""Lloyd"")"
"0",""
"0","{"
"0","ch = numeric(length=kmax-1)"
"0","n = nrow(x)"
"0","for (k in 2:kmax) {"
"0","a = kmeans(x,k,iter.max=iter.max,nstart=nstart,"
"0",""
"0","algorithm=algorithm)"
"0",""
"0","w = a$tot.withinss"
"0","b = a$betweenss"
"0","ch[k-1] = (b/(k-1))/(w/(n-k))"
"0","}"
"0","return(list(k=2:kmax,ch=ch))"
"0","}"
"0","ch_index = ch.index(breastData,kmax=10)"
"0","ch_index"
"1","$k
"
"1","[1]"
"1","  2"
"1","  3"
"1","  4"
"1","  5"
"1","  6"
"1","  7"
"1","  8"
"1","  9"
"1"," 10"
"1","
"
"1","
"
"1","$ch
"
"1","[1]"
"1"," 1300.208"
"1"," 1154.903"
"1"," 1465.673"
"1"," 1609.690"
"1"," 1583.703"
"1"," 1706.789"
"1"," 1695.835"
"1"," 1672.262"
"1"," 1660.340"
"1","
"
"1","
"
"0","best_k <- ch_index$k[which.max(ch_index$ch)]"
"0","best_k"
"1","[1]"
"1"," 7"
"1","
"
